(window.__LOADABLE_LOADED_CHUNKS__=window.__LOADABLE_LOADED_CHUNKS__||[]).push([[18],{120:function(e,t,o){"use strict";var s=o(5),i=o(286),n=o(307);const r=s.h.getInstance().shouldUseLayoutBlocks()?i.a:n.a;t.a=r},141:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var o=[],s=!0,i=!1,n=void 0;try{for(var r,a=e[Symbol.iterator]();!(s=(r=a.next()).done)&&(o.push(r.value),!t||o.length!==t);s=!0);}catch(e){i=!0,n=e}finally{try{!s&&a.return&&a.return()}finally{if(i)throw n}}return o}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},i=l(o(2)),n=o(0),r=l(n),a=l(o(123));function l(e){return e&&e.__esModule?e:{default:e}}o(201);var c=function(e){return Array.from({length:e},(function(e,t){return t+1}))};a.default.setAppElement("body");var d=function(e){var t=e.detractorFollowUpQuestion,o=e.detractorUpperBound,i=e.header,l=e.mainQuestion,d=e.maxScore,u=e.maxScoreBlurb,h=e.minScoreBlurb,m=e.modalClassName,p=e.modalClassPrefix,w=e.neutralFollowUpQuestion,f=e.onCommentSubmit,g=e.onScoreClick,y=e.overlayClassName,k=e.promoterFollowUpQuestion,R=e.promoterLowerBound,b=(0,n.useState)(c(d)),C=s(b,2),S=C[0],I=C[1],_=(0,n.useState)(!0),B=s(_,2),v=B[0],x=B[1],O=(0,n.useState)(!1),E=s(O,2),W=E[0],L=E[1],P=(0,n.useState)(),N=s(P,2),T=N[0],D=N[1],U=(0,n.useState)(),j=s(U,2),M=j[0],z=j[1],F=(0,n.useState)(""),A=s(F,2),H=A[0],q=A[1],Q=(0,n.useState)(),$=s(Q,2),V=$[0],K=$[1];(0,n.useEffect)((function(){I(c(d))}),[d]),(0,n.useEffect)((function(){D(M<=o?t:M<R?w:k)}),[M]),(0,n.useEffect)((function(){V&&(V.style.opacity="100%",V.style.top="120px")}),[V]);var X=function(){V&&(V.style.opacity="0",V.style.top="0"),setTimeout((function(){x(!1)}),200)};return r.default.createElement(a.default,{id:"nps-modal",isOpen:v,className:"nps-modal__content "+m,contentRef:function(e){return K(e)},onRequestClose:X,overlayClassName:"nps-modal__overlay "+y},r.default.createElement("button",{className:"close-button",onClick:X},"Ã—"),!!i&&r.default.createElement("h2",{className:[p,"modal-header"].join("-")},i),r.default.createElement("div",{className:[p,"modal-body"].join("-")},W?r.default.createElement("form",{className:"follow-up-container",onSubmit:function(e){e.preventDefault(),f(H,T),X()}},r.default.createElement("label",{htmlFor:"comment-input",className:"question-prompt"},T),r.default.createElement("textarea",{className:"comment-input",id:"comment-input",onChange:function(e){var t=e.target;return q(t.value)},rows:"3",value:H}),r.default.createElement("div",{className:"form-actions"},r.default.createElement("button",{className:"button-submit",type:"submit"},"Submit"))):r.default.createElement("div",{className:"score-selector-container",onMouseLeave:function(){return z(void 0)}},r.default.createElement("p",{className:"question-prompt"},l),r.default.createElement("div",{className:"scroll-container"},r.default.createElement("div",{className:"score-selector"},r.default.createElement("div",{className:"score-options"},S.map((function(e){return r.default.createElement("button",{key:e,className:"score-selection "+(e<=M?"score-selection__active":""),onMouseEnter:function(){return z(e)},onClick:function(){return e=M,g(M,l),z(e),void L(!0);var e}},e)}))),r.default.createElement("div",{className:"score-labels"},r.default.createElement("p",{className:"score-label score-label__min"},h),r.default.createElement("p",{className:"score-label score-label__max"},u)))))))};d.propTypes={header:i.default.string,modalClassName:i.default.string,modalClassPrefix:i.default.string,overlayClassName:i.default.string,mainQuestion:i.default.string.isRequired,promoterFollowUpQuestion:i.default.string.isRequired,neutralFollowUpQuestion:i.default.string.isRequired,detractorFollowUpQuestion:i.default.string.isRequired,maxScore:i.default.number.isRequired,detractorUpperBound:i.default.number.isRequired,promoterLowerBound:i.default.number.isRequired,minScoreBlurb:i.default.string,maxScoreBlurb:i.default.string,onScoreClick:i.default.func.isRequired,onCommentSubmit:i.default.func.isRequired},d.defaultProps={header:"",maxScoreBlurb:"Very likely",minScoreBlurb:"Not likely",modalClassName:"nps-modal",modalClassPrefix:"",overlayClassName:""},t.default=d},201:function(e,t,o){"use strict";o.r(t)},286:function(e,t,o){"use strict";var s=o(159),i=o.n(s),n=o(2),r=o.n(n),a=o(0),l=o.n(a),c=o(1),d=o(13),u=o(3),h=o(565),m=o(574),p=o.n(m),w=o(544),f=o.n(w);var g=class{constructor(e,t,o,s,i,n,r){this.totalHeight=0,this.blockCount=0,this.workingRow=[],this.grid=[],this.stockItems=e,this.positions={},this.layoutWidth=t,this.height=o,this.workingWidth=t,this.threshold=s,this.hideLastRow=i,this.minWidth=n,this.drawerIsLoading=!1,this.drawerIsOpen=!1,this.drawerItemCount=0,this.selectedBlockIndex=-1,this.itemsPerRow=0,this.layoutUpdateCallback=r||f.a}setDrawerClosed(){this.drawerIsLoading=!1,this.drawerIsOpen=!1,this.selectedBlockIndex=-1}setDrawerLoading(e){this.drawerIsLoading=!0,this.drawerIsOpen=!0,e>=0?this.selectedBlockIndex=e:console.error(`Cannot set drawer as open with a selected block index of ${e}`)}setDrawerPopulated(e,t,o){e>=0?this.selectedBlockIndex=e:console.error(`Cannot set drawer as open with a selected block index of ${e}`),this.drawerIsLoading=!1,this.drawerIsOpen=!0,this.drawerItemCount=t,this.itemsPerRow=o}compute(){p()(this.stockItems,(e=>{if(!("aspectRatio"in e.stockItem))return console.error("Objects passed to layoutBlocks must contain aspectRatio parameter"),!0;const t={id:e.stockItem.id,aspectRatio:e.stockItem.aspectRatio||1,noAspectRatio:null==e.stockItem.aspectRatio};this._addBlock(t)})),this.workingRow.length>0&&this._finishRow();let e={};if(this.drawerIsOpen){const t=1+this.getContainingRow(this.selectedBlockIndex),o=this.getTotalHeightOfPrecedingRows(t);e={width:this.layoutWidth,x:0,y:o}}this.layoutUpdateCallback(this.positions,this.totalHeight,e)}getContainingRow(e){if(e>this.blockCount)return-1;let t=0;for(let o=0;o<this.grid.length;o++)if(t+=this.grid[o].length,t>e)return o;return-1}getLastBlockIndexInContainingRow(e){let t=0;for(let o=0;o<this.grid.length&&(t+=this.grid[o].length-1,!(t>=e));o++);return t}getTotalHeightOfPrecedingRows(e){return this.grid.slice(0,e).reduce(((e,t)=>e+Math.floor(this.positions[t[0].id].height)),0)}getXMidpointForBlockById(e){if(!e)return null;const t=this.positions[e];return t.x+Math.floor(t.width/2)}_addBlock(e){this.blockCount+=1;const t=this._getBlockWidth(e,this.height);t<this.workingWidth?this._addBlockToWorkingRow(e,t):t>this.workingWidth&&this.workingWidth>this.threshold?(this._addBlockToWorkingRow(e,t),this._finishRow()):t>this.workingWidth&&this.workingWidth<=this.threshold?(this._finishRow(),this._addBlockToWorkingRow(e,t)):this._finishRow(e,t)}_finishRow(e,t){e&&this._addBlockToWorkingRow(e,t),this._scaleWorkingRow(),this.grid.push(this.workingRow),this._resetWorkingRow(),this._accountForDrawer()}_addBlockToWorkingRow(e,t){this.workingRow.push(e),this.workingWidth-=t}_getBlockWidth(e,t){const o=e.aspectRatio*t,s=o<this.minWidth,i=o>this.layoutWidth;return s?(e.noAspectRatio=!0,t*this.minWidth/this.height):i?(e.noAspectRatio=!0,this.layoutWidth):o}_resetWorkingRow(){this.workingWidth=this.layoutWidth,this.workingRow=[]}_getPreviewPos(e,t){const o=e+t;return e>this.layoutWidth-o?"left":"right"}_scaleWorkingRow(){let e,t,o,s,i,n=!1,r=0,a=this.totalHeight;this.blockCount<this.stockItems.length||this.workingWidth<0||this.workingWidth>0&&this.workingWidth<this.threshold?(e=this.height,t=this.layoutWidth-this.workingWidth,o=this.layoutWidth,s=o*e/t):this.hideLastRow?n=!0:s=+this.height,n?p()(this.workingRow,(e=>{i=null,this.positions[e.id]=null})):(p()(this.workingRow,(e=>{i=this._getBlockWidth(e,s),this.positions[e.id]=this._getPosition(r,a,i,s),r+=i})),this.totalHeight+=s)}_getPosition(e,t,o,s){return{x:e,y:t,width:o,height:s,previewPos:this._getPreviewPos(e,o)}}_accountForDrawer(){const e=this.getContainingRow(this.selectedBlockIndex);if(this.drawerIsOpen&&e===this.grid.length-1)if(this.drawerIsLoading)this.totalHeight+=1.3*this.height;else{const e=Math.ceil(this.drawerItemCount/this.itemsPerRow);this.totalHeight+=this._getDrawerOffset(e,this.height)}}_getDrawerOffset(e,t){return e*(t+10+2)+130}},y=o(307);function k(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}class R extends y.a{constructor(e){super(e),k(this,"windowResizeTimer",null),k(this,"layoutEngine",null),k(this,"layoutBlocksPadding",8),k(this,"handleResize",(e=>{e=e||100,this.windowResizeTimer&&clearTimeout(this.windowResizeTimer),this.windowResizeTimer=setTimeout(this.handleLayoutUpdate,e)})),k(this,"handleLayoutUpdate",(()=>{if(this.searchResultsContainerRef){const e=this.searchResultsContainerRef.offsetWidth;this.setState({needsLayoutShift:!1,layoutBlocksTotalWidth:e},(()=>this.initializeLayoutBlocks(this.props)))}})),k(this,"initializeLayoutBlocks",(e=>{const{currentStockItems:t,drawerContentLoaded:o,drawerIsOpen:s,drawerSelectedItemId:i,drawerNumberItemsVisible:n,itemsPerRow:r,pagination:a}=e,l=this.state.layoutBlocksTotalWidth,c=a&&a.hasMoreResults||!1;if(this.layoutEngine=new g(t,l,200,200,c,120,((e,t,o)=>{this.setState({drawerPosition:o,layoutBlocksPositions:e,layoutBlocksTotalHeight:t})})),s){const e=t.findIndex((e=>e.stockItem.id===i));o?this.layoutEngine.setDrawerPopulated(e,n,r):this.layoutEngine.setDrawerLoading(e)}else this.layoutEngine.setDrawerClosed();this.layoutEngine.compute()})),this.state={needsLayoutShift:!0,drawerPosition:{},layoutBlocksPositions:{},layoutBlocksTotalWidth:1800,layoutBlocksTotalHeight:400}}componentDidMount(){this.initializeLayoutBlocks(this.props),this.handleResize(500),window.addEventListener("resize",(()=>{this.props.drawerIsOpen&&this.props.closeDrawer(),this.handleResize()}))}componentWillUnmount(){window.removeEventListener("resize",this.handleResize)}UNSAFE_componentWillReceiveProps(e){this.initializeLayoutBlocks(e)}componentDidUpdate(e){this.props!==e&&this.handleResize(500)}getSearchResultsCSSClasses(){return super.getSearchResultsCSSClasses().concat(["layout","horizontal","scale","content-info"])}getSearchResultsListStyles(){return{minHeight:this.state.layoutBlocksTotalHeight+10}}getSearchResultsContainerCSSClasses(){return super.getSearchResultsCSSClasses().concat(["layout-container"])}getStockItemCardCSSClasses(e){const t=[],o=e.stockItem.id,s=this.state.layoutBlocksPositions[o];return o in this.state.layoutBlocksPositions&&t.push(s?"layoutBlock":"hiddenLayoutBlock"),super.getSearchResultsCSSClasses().concat(t)}getStockItemCardStyles(e){let t={display:"none"};const o=e.stockItem.id,s=this.state.layoutBlocksPositions[o];return o in this.state.layoutBlocksPositions&&s&&(t={left:s.x+"px",top:s.y+"px",width:s.width+"px",height:s.height+"px",padding:this.layoutBlocksPadding+"px"}),i()(super.getStockItemCardStyles(),t)}getStockItemCardImageCSSClasses(e){const t=[];return"aspectRatio"in e.stockItem&&!e.stockItem.aspectRatio&&t.push("noAspectRatio"),super.getStockItemCardImageCSSClasses().concat(t)}getDrawerStyles(){const{width:e,x:t,y:o}=this.state.drawerPosition;return{left:`${t}px`,top:`${o}px`,width:`${e}px`,"z-index":"100"}}calculateDrawerIndex(e){return 1+this.layoutEngine.getLastBlockIndexInContainingRow(e)}calculateIndicatorOffset(e){return this.layoutEngine.getXMidpointForBlockById(e)}buildDrawer(e){const t=this.calculateIndicatorOffset(e);return l.a.createElement(h.a,{indicatorClasses:"pointer",key:`drawer-for-${e}`,selectedItemId:e,selectedItemIndicatorOffset:t,customStyles:this.getDrawerStyles()})}}k(R,"propTypes",{...y.a.propTypes,currentStockItems:r.a.array,closeDrawer:r.a.func.isRequired,drawerContentLoaded:r.a.bool,drawerIsOpen:r.a.bool,drawerNumberItemsVisible:r.a.number,itemsPerRow:r.a.number}),k(R,"defaultProps",{drawerContentLoaded:!1,drawerIsOpen:!1});t.a=Object(c.b)((function(e){const t=Object(u.C)(e);return{drawerContentLoaded:Object(u.f)(e),features:Object(u.x)(e),isSideMenuOpened:Object(u.l)(e),drawerNumberItemsVisible:Object(u.w)(e),isNewSideMenuOpened:t.isOpen,isNewSideMenuSubMenuOpened:t.subMenu.isOpen}}),(function(e){return{closeDrawer:()=>e(Object(d.e)())}}))(R)},56:function(e,t,o){"use strict";var s=o(141),i=o.n(s),n=o(0),r=o.n(n),a=o(1),l=o(27),c=o(167);const d=e=>e.npsModal.surveyId,u=e=>e.npsModal.context,h=e=>e.npsModal.responsePromise;t.a=()=>{const e=Object(a.c)(),t=Object(a.d)((e=>{var t,o;return null===(t=e.auth)||void 0===t||null===(o=t.user)||void 0===o?void 0:o.id})),o=Object(a.d)(d),s=Object(a.d)(u),m=Object(a.d)(h);return Object(n.useEffect)((()=>{l.a.telemetry.increment("nps.modal.rendered")}),[]),r.a.createElement(i.a,{mainQuestion:"How likely are you to recommend Storyblocks to a friend or colleague?",promoterFollowUpQuestion:"We're so happy you're happy! Can you please tell us more about your experience?",neutralFollowUpQuestion:"Thanks for your feedback! Can you please tell us more about your experience?",detractorFollowUpQuestion:"Thanks for your feedback. What could we do to improve your experience?",maxScore:10,detractorUpperBound:6,promoterLowerBound:9,onScoreClick:i=>{const n="/"+__CURRENT_SITE__+"/survey/"+o+"/"+t+"/"+i+"?context="+s+"&ajax=1",r=fetch(new Request(n,{method:"GET"}));e(Object(c.b)(r)),l.a.telemetry.gauge("nps.modal.scored",i)},onCommentSubmit:e=>{l.a.telemetry.increment("nps.modal.commented"),m.then((t=>{t.ok&&t.json().then((t=>{const o=new URLSearchParams;o.append("response_id",t.responseId),o.append("comment",e),fetch("/survey",{body:o,method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}})}))}))},overlayClassName:"z-1000",modalClassName:"w-screen md:w-auto",modalClassPrefix:"nps"})}}}]);