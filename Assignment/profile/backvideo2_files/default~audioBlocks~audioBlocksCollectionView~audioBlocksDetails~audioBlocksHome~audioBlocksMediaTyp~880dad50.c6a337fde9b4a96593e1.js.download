(window.__LOADABLE_LOADED_CHUNKS__=window.__LOADABLE_LOADED_CHUNKS__||[]).push([[15,40],{231:function(e,t,n){"use strict";n.d(t,"b",(function(){return l})),n.d(t,"e",(function(){return p})),n.d(t,"a",(function(){return m})),n.d(t,"c",(function(){return y})),n.d(t,"d",(function(){return g}));var s=n(110),i=n(93),o=n.n(i),r=n(16),a=n(94),c=n(90),d=n(6);function u(e){return Math.floor(Math.abs(Date.parse(e)-new Date)/1e3/86400)}function l(e,t,n,i,l,p,m,y,h,g){if(a.a.produceDownloadClickEvent(t,m&&m.position),i){e.preventDefault();const t=e.target.dataset.format,a=n.find((e=>e.formatName===t));r.Telemetry.increment("download.clicked.stockItemCard"),y&&r.Telemetry.increment(`download.clicked.${y}`);const I=Object(d.f)(m);return I&&(g.origin_area=I),(new c.a).getDataBridge().downloadItem(s.stringifyUrl({url:a.downloadUrl,query:g},{skipNull:!0}),s.stringifyUrl({url:a.downloadAjaxUrl,query:g},{skipNull:!0}),p,h,l||i),function(){if("function"==typeof hj){const e=o.a.load("audio_survey",!1)||null;(!e||u(e)>=14)&&(hj("trigger","search_difficulty"),o.a.save("audio_survey",new Date,{path:"/",domain:"."+window.location.hostname}))}}(),!1}}function p(e,t){window.sessionStorage&&window.sessionStorage.setItem(e,t)}function m(e){if(window.sessionStorage){const t=JSON.parse(window.sessionStorage.getItem(e));return null!==t?t:1}}function y(){return JSON.parse(window.sessionStorage.getItem("playedClips"))||{}}function h(e){const t="visitor_library_quality";if("function"==typeof hj&&e&&!JSON.parse(window.sessionStorage.getItem("visitor_library_quality"))){const e=y();(e.stockItemIds?e.stockItemIds.length:0)>=10&&(hj("trigger",t),window.sessionStorage.setItem(t,JSON.stringify(!0)))}}function g(e,t){!function(e,t){if(window.sessionStorage){const n=y(),s=n.lastListened?new Date(n.lastListened):new Date;let i=n.stockItemIds||[];u(s)>=7&&(i=[]),!t&&n.isLoggedIn&&(i=[]),i.push(e),n.stockItemIds=Array.from(new Set(i)),n.lastListened=new Date,n.isLoggedIn=t,window.sessionStorage.setItem("playedClips",JSON.stringify(n))}}(e.id,t),h(!t)}},55:function(e,t,n){"use strict";n.d(t,"k",(function(){return s})),n.d(t,"j",(function(){return i})),n.d(t,"f",(function(){return o})),n.d(t,"g",(function(){return r})),n.d(t,"i",(function(){return a})),n.d(t,"h",(function(){return c})),n.d(t,"l",(function(){return d})),n.d(t,"d",(function(){return u})),n.d(t,"c",(function(){return l})),n.d(t,"e",(function(){return p})),n.d(t,"m",(function(){return m})),n.d(t,"b",(function(){return y})),n.d(t,"a",(function(){return h}));const s=e=>e.audio.isPlaying,i=e=>e.audio.isPaused,o=e=>e.audio.audioSourceUrl,r=e=>e.audio.currentTime,a=e=>e.audio.duration,c=e=>e.audio.currentVolume,d=e=>e.audio.pastVolume,u=e=>e.audio.pending,l=e=>e.audio.meta,p=e=>e.audio.pending.stockItem,m=e=>e.audio.volume,y=e=>e.audio.filtersChanged,h=e=>e.audio.context},804:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AudioPreviewEvent=void 0;const s=n(138);class i extends s.BaseAvroRecord{constructor(){super(...arguments),this.stockItemContext=null,this.drawerType=null}schema(){return i.schema}subject(){return i.subject}}t.AudioPreviewEvent=i,i.subject="audio-preview-event",i.schema={type:"record",name:"AudioPreviewEvent",namespace:"storyblocks.content",fields:[{name:"meta",type:{type:"record",name:"Meta",namespace:"storyblocks.common",fields:[{name:"uuid",type:"string"},{name:"emitted",type:{type:"long",logicalType:"timestamp-millis"}},{name:"origin",type:{type:"enum",name:"Origin",symbols:["VIDEOBLOCKS","AUDIOBLOCKS","GRAPHICSTOCK","STORYBLOCKS","CONTRIBUTOR_PORTAL","TEMPLATE_EDITOR","ACCOUNT_SERVICE","BILLING_SERVICE","CONTENT_SERVICE","PAYOUT_SERVICE","TRANSLATION_SERVICE","CONTENT_RATING_APP","FEATURE_FLAG_SERVICE","PREMIERE_PRO_PLUGIN","AFTER_EFFECTS_PLUGIN","EXAMPLE_SERVICE","SEARCH_SERVICE","CONTENT_JOB","DATA_JOB","MISC","STORYBOARD","OUTDATED_SCHEMA"],default:"OUTDATED_SCHEMA"}},{name:"trace",type:["null",{type:"record",name:"TraceContext",fields:[{name:"traceId",type:"string"},{name:"pageTraceId",type:"string",default:""},{name:"spanId",type:"string"},{name:"parentId",type:"string",default:""}]}],default:null}]}},{name:"user",type:{type:"record",name:"User",namespace:"storyblocks.common",fields:[{name:"visitorCookieId",type:["null","string"]},{name:"userId",type:["null","int"]},{name:"subscriptionId",type:["null","int"]},{name:"organizationId",type:["null","int"],default:null}]}},{name:"urls",type:{type:"record",name:"Urls",namespace:"storyblocks.common",fields:[{name:"currentUrl",type:"string"},{name:"referrerUrl",type:["null","string"],default:null}]}},{name:"device",type:{type:"record",name:"Device",namespace:"storyblocks.common",fields:[{name:"browser",type:["null",{type:"record",name:"Browser",namespace:"storyblocks.common.frontend",fields:[{name:"userAgent",type:"string"},{name:"language",type:"string"},{name:"platform",type:"string"},{name:"name",type:"string"}]}],default:null},{name:"tab",type:["null",{type:"record",name:"Tab",namespace:"storyblocks.common.frontend",fields:[{name:"isNewTab",type:"boolean"},{name:"tabCount",type:"int"},{name:"tabId",type:"string"}]}],default:null},{name:"navigation",type:{type:"record",name:"Navigation",namespace:"storyblocks.common.frontend",fields:[{name:"referrerUrl",type:"string"},{name:"navigationType",type:["null",{type:"enum",name:"NavigationType",namespace:"storyblocks.common.enums",symbols:["TYPE_NAVIGATE","TYPE_RELOAD","TYPE_BACK_FORWARD","TYPE_RESERVED","OUTDATED_SCHEMA"],default:"OUTDATED_SCHEMA"}],default:null}]}}]}},{name:"searchIdentifiers",type:{type:"record",name:"SearchIdentifiers",namespace:"storyblocks.search.records",fields:[{name:"searchId",type:"string",doc:"f.k.a. SSLID"},{name:"searchPageId",type:"string",doc:"f.k.a. SGUID"},{name:"lastSearchId",type:["null","string"],doc:"Previous searchId",default:null}]}},{name:"stockItem",type:{type:"record",name:"ShallowStockItem",namespace:"storyblocks.content.records",fields:[{name:"stockItemId",type:"int"},{name:"title",type:"string"},{name:"distributionType",type:{type:"enum",name:"DistributionType",namespace:"storyblocks.content.enums",symbols:["MEMBER_LIBRARY","REV_SHARE","MARKETPLACE","OUTDATED_SCHEMA"],default:"OUTDATED_SCHEMA"}},{name:"publishedDate",type:{type:"long",logicalType:"timestamp-millis"}},{name:"distributionTypeUpdatedDate",type:["null",{type:"long",logicalType:"timestamp-millis"}],default:null},{name:"contentType",type:{type:"enum",name:"ContentType",namespace:"storyblocks.content.enums",symbols:["ALL","LOOPS","MUSIC","SOUND_EFFECTS","ILLUSTRATIONS","PHOTOS","VECTORS","FOOTAGE","MOTION_BACKGROUNDS","TEMPLATES","VR_360","OUTDATED_SCHEMA"],default:"OUTDATED_SCHEMA"}},{name:"format",type:["null","string"],default:null}]}},{name:"durationMs",type:"int"},{name:"playStartMs",type:"int",doc:"Relative to the beginning of the track."},{name:"playEndMs",type:"int",doc:"Relative to the beginning of the track."},{name:"stockItemContext",type:["null","string"],default:null},{name:"drawerType",type:["null","string"],default:null}]}},91:function(e,t,n){"use strict";var s=n(0),i=n.n(s),o=n(1),r=n(804),a=n(27),c=n(329);var d=n(3),u=n(12),l=n(8),p=n(10),m=n(231),y=n(30),h=n(55);function g(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const I="pastVolume",f="currentVolume";class E extends s.Component{constructor(...e){super(...e),g(this,"audio",void 0),g(this,"state",{playStartMs:0,playEndMs:0}),g(this,"producePreviewEventIfPlaying",((e=null,t=null)=>{const n=e||this.props,s=t||this.state,i=null==n?void 0:n.stockItem,o=null==s?void 0:s.playStartMs,d=null==s?void 0:s.playEndMs,u=Math.round(1e3*n.duration),l=d-o,m=Math.min(u,1e3),y=n.stockItemContext,h=y===p.c.DRAWER?n.drawerType:null;if(!(!n.isPlaying||o>d||isNaN(u)||l<m))try{const e=class{static create(e,t,n,s,i,o){const d=new r.AudioPreviewEvent;return d.meta=a.a.meta(),d.device=a.a.device(),d.user=a.a.user(),d.urls=a.a.urls(),d.searchIdentifiers=a.a.getSearchIdentifiers(),d.stockItem=c.a.create(e),d.durationMs=s,d.playStartMs=t,d.playEndMs=n,d.stockItemContext=i,d.drawerType=o,d}}.create(i,o,d,u,y,h);a.a.produce(e,e.user.visitorCookieId)}catch(e){}}))}componentDidMount(){if("search"===this.props.context){const e=Object(m.a)(f),t=Object(m.a)(I);this.props.dispatch(Object(y.l)(e)),this.props.dispatch(Object(y.m)(t))}this.audio.addEventListener("timeupdate",(()=>{this.setState({playEndMs:Math.round(1e3*this.audio.currentTime)}),this.props.dispatch(Object(y.j)(this.audio.currentTime,this.audio.duration))})),this.audio.addEventListener("loadstart",(()=>{this.props.dispatch(Object(y.i)(this.audio.src))})),this.audio.addEventListener("seeking",(()=>{this.producePreviewEventIfPlaying(),this.setState({playStartMs:Math.round(1e3*this.audio.currentTime)})})),this.audio.addEventListener("playing",(()=>{this.props.dispatch(Object(y.e)())})),this.audio.addEventListener("pause",(()=>{this.producePreviewEventIfPlaying(),this.props.dispatch(Object(y.d)())})),this.audio.addEventListener("ended",(()=>{this.props.contentTypeFilter===l.c.MUSIC&&this.playNext()})),window.onbeforeunload=()=>this.producePreviewEventIfPlaying()}componentDidUpdate(e,t){let n=!1;null!==this.props.pendingCurrentVolume&&(Object(m.e)(f,this.props.pendingCurrentVolume),this.props.dispatch(Object(y.f)(this.props.pendingCurrentVolume)),this.audio.volume=this.props.pendingCurrentVolume,n=!0),null!==this.props.pendingPastVolume&&(Object(m.e)(I,this.props.pendingPastVolume),this.props.dispatch(Object(y.h)(this.props.pendingPastVolume)),n=!0),this.props.pendingAudioSourceUrl&&this.props.audioSourceUrl!==this.props.pendingAudioSourceUrl&&(this.audio.src=this.props.pendingAudioSourceUrl,n=!0),null!==this.props.pendingCurrentTime&&this.props.pendingCurrentTime>=0&&(this.audio.currentTime=this.props.pendingCurrentTime,n=!0),this.props.pendingShouldPlay&&(this.audio.play(),n=!0),this.props.pendingShouldPause&&(this.audio.pause(),n=!0),this.props.pendingPlayNext&&(this.playNext(),n=!0),this.props.pendingPlayPrev&&(this.playPrev(),n=!0),e.stockItem&&this.props.stockItem&&e.stockItem.id!==this.props.stockItem.id&&!1!==e.isPlaying&&this.producePreviewEventIfPlaying(e,t),n&&this.props.dispatch(Object(y.c)())}async playNext(){const{searchStockItems:e}=this.props;if(e.length){const e=this.determineQueuedTrack(1);await this.playQueuedTrack(e)}}async playPrev(){const{currentTime:e,stockItem:t,stockItemArtists:n,stockItemFormats:s,searchStockItems:i}=this.props;if(i.length){const i=e>=3?{stockItem:t,stockItemArtists:n,stockItemFormats:s}:this.determineQueuedTrack(-1);await this.playQueuedTrack(i)}}async playQueuedTrack(e){const{dispatch:t,isLoggedIn:n}=this.props;let s={};try{const t=await fetch(e.stockItem.waveformUrl);s=await t.json()}catch(e){}t(Object(y.o)(e.stockItem.previewUrl,0,e.stockItem,e.stockItemArtists,e.stockItemFormats,s)),Object(m.d)(e.stockItem,n)}determineQueuedTrack(e){const{stockItem:t,filtersChanged:n}=this.props,s=this.getCombinedStockItems();if(n)return s[0];const i=s.findIndex((e=>e.stockItem.id===t.id));if(-1!==i){if(-1===e&&0===i)return s[i];const t=i+e;return t>=s.length?s[0]:s[t]}const o=s.findIndex((e=>e.stockItem.collapsedSetId===t.collapsedSetId));if(-1!==o){const t=o+e;return t>=s.length?s[0]:s[t]}return s[0]}getCombinedStockItems(){const{searchStockItems:e,collapsedSetStockItems:t,drawerIsOpen:n,drawerContentLoaded:s,drawerSelectedItemId:i}=this.props,o=[...e];if(n&&s&&i){const e=o.findIndex((e=>e.stockItem.id===i));o.splice(e+1,0,...t)}return o}render(){return i.a.createElement("audio",{id:"audio",ref:e=>this.audio=e},i.a.createElement("source",{type:"audio/mpeg",src:this.props.audioSourceUrl}))}}t.a=Object(o.b)((function(e){const t=Object(h.d)(e),{stockItem:n,stockItemArtists:s,stockItemFormats:i}=Object(h.c)(e),o=Object(d.y)(e);return{isPlaying:Object(h.k)(e),isPaused:Object(h.j)(e),audioSourceUrl:Object(h.f)(e),currentTime:Object(h.g)(e),duration:Object(h.i)(e),currentVolume:Object(h.h)(e),pastVolume:Object(h.l)(e),pendingCurrentVolume:t.currentVolume,pendingPastVolume:t.pastVolume,pendingMute:t.mute,pendingCurrentTime:t.currentTime,pendingAudioSourceUrl:t.audioSourceUrl,pendingShouldPlay:t.play,pendingShouldPause:t.pause,pendingPlayNext:t.playNext,pendingPlayPrev:t.playPrev,stockItem:n,stockItemArtists:s,stockItemFormats:i,searchStockItems:Object(d.P)(e),collapsedSetStockItems:Object(d.c)(e),isLoggedIn:Object(u.i)(e),drawerIsOpen:Object(d.g)(e),drawerContentLoaded:Object(d.f)(e),drawerSelectedItemId:Object(d.h)(e),drawerType:Object(d.i)(e),filtersChanged:Object(h.b)(e),context:Object(d.s)(e),contentTypeFilter:o.contentType,stockItemContext:Object(h.a)(e)}}))(E)}}]);